<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Test</title>
</head>
<body>
    <h1>Firebase Connection Test</h1>
    <button id="testBtn">Test Firebase Connection</button>
    <button id="sendBtn">Send Test Message</button>
    <div id="status"></div>
    <div id="messages"></div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, push, onValue, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        // REPLACE THIS WITH YOUR EXACT CONFIG FROM FIREBASE CONSOLE
        const firebaseConfig = {
            apiKey: "AIzaSyAsJh8qq9RvkrGlhwtnt_1RMyVmkCA7b3Y",
            authDomain: "sms-coin-7f745.firebaseapp.com",
            databaseURL: "https://sms-coin-7f745-default-rtdb.firebaseio.com/",
            projectId: "sms-coin-7f745",
            storageBucket: "sms-coin-7f745.firebasestorage.app",
            messagingSenderId: "294441486394",
            appId: "1:294441486394:web:f6e2d6fe1675769f838d03"
        };

        const status = document.getElementById('status');
        const messages = document.getElementById('messages');

        function log(message) {
            console.log(message);
            status.innerHTML += '<br>' + message;
        }

        try {
            log('1. Initializing Firebase...');
            const app = initializeApp(firebaseConfig);
            log('2. Firebase app initialized successfully');

            log('3. Getting database instance...');
            const database = getDatabase(app);
            log('4. Database instance created');

            log('5. Creating messages reference...');
            const messagesRef = ref(database, 'test-messages');
            log('6. Messages reference created');

            // Test connection by listening
            document.getElementById('testBtn').addEventListener('click', () => {
                log('7. Testing database connection...');
                
                onValue(messagesRef, (snapshot) => {
                    log('8. ✅ Database connection successful!');
                    log('Data: ' + JSON.stringify(snapshot.val()));
                }, (error) => {
                    log('8. ❌ Database connection failed: ' + error.message);
                });
            });

            // Test sending data
            document.getElementById('sendBtn').addEventListener('click', () => {
                log('9. Sending test message...');
                
                push(messagesRef, {
                    text: 'Test message ' + Date.now(),
                    timestamp: serverTimestamp()
                }).then(() => {
                    log('10. ✅ Message sent successfully!');
                }).catch((error) => {
                    log('10. ❌ Send failed: ' + error.message);
                });
            });

            // Listen for messages
            onValue(messagesRef, (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    messages.innerHTML = '<h3>Messages:</h3>' + JSON.stringify(data, null, 2);
                }
            });

        } catch (error) {
            log('❌ Initialization error: ' + error.message);
        }
    </script>
</body>
</html>